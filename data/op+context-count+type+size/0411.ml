
type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Tan of expr
  | Average of expr* expr
  | Times of expr* expr
  | TimesMod of expr* expr* expr
  | Thresh of expr* expr* expr* expr;;

let pi = 4.0 *. (atan 1.0);;

let rec eval (e,x,y) =
  match e with
  | Thresh (w,t,u,z) ->
      if (eval (w, x, y)) < (eval (t, x, y))
      then eval (u, x, y)
      else eval (z, x, y)
  | TimesMod (w,t,u) ->
      ((eval (w, x, y)) *. (eval (t, x, y))) /.
        (mod_float ((eval (w, x, y)) *. (eval (t, x, y))) (eval (u, x, y)))
  | Times (t,u) -> (eval (t, x, y)) *. (eval (u, x, y))
  | Average (t,u) -> ((eval (t, x, y)) +. (eval (u, x, y))) /. 2.0
  | Cosine t -> cos (pi *. (eval (t, x, y)))
  | Sine t -> sin (pi *. (eval (t, x, y)))
  | Tan t -> mod_float (tan (pi *. (eval (t, x, y)))) 1
  | VarX  -> x
  | VarY  -> y;;


(* fix

type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Tan of expr
  | Average of expr* expr
  | Times of expr* expr
  | TimesMod of expr* expr* expr
  | Thresh of expr* expr* expr* expr;;

let pi = 4.0 *. (atan 1.0);;

let rec eval (e,x,y) =
  match e with
  | Thresh (w,t,u,z) ->
      if (eval (w, x, y)) < (eval (t, x, y))
      then eval (u, x, y)
      else eval (z, x, y)
  | TimesMod (w,t,u) ->
      ((eval (w, x, y)) *. (eval (t, x, y))) /.
        (mod_float ((eval (w, x, y)) *. (eval (t, x, y))) (eval (u, x, y)))
  | Times (t,u) -> (eval (t, x, y)) *. (eval (u, x, y))
  | Average (t,u) -> ((eval (t, x, y)) +. (eval (u, x, y))) /. 2.0
  | Cosine t -> cos (pi *. (eval (t, x, y)))
  | Sine t -> sin (pi *. (eval (t, x, y)))
  | Tan t -> mod_float (tan (pi *. (eval (t, x, y)))) 1.0
  | VarX  -> x
  | VarY  -> y;;

*)

(* changed spans
(28,55)-(28,56)
*)

(* type error slice
(13,4)-(13,29)
(13,10)-(13,26)
(15,15)-(30,15)
(16,3)-(30,15)
(16,3)-(30,15)
(16,3)-(30,15)
(16,3)-(30,15)
(16,3)-(30,15)
(16,3)-(30,15)
(16,3)-(30,15)
(16,3)-(30,15)
(16,3)-(30,15)
(16,3)-(30,15)
(16,3)-(30,15)
(16,3)-(30,15)
(16,3)-(30,15)
(16,3)-(30,15)
(16,3)-(30,15)
(16,3)-(30,15)
(16,3)-(30,15)
(16,3)-(30,15)
(16,3)-(30,15)
(16,3)-(30,15)
(16,3)-(30,15)
(16,9)-(16,10)
(18,7)-(20,25)
(18,7)-(20,25)
(18,11)-(18,15)
(18,11)-(18,24)
(18,11)-(18,24)
(18,11)-(18,43)
(18,11)-(18,43)
(18,11)-(18,43)
(18,17)-(18,18)
(18,17)-(18,24)
(18,20)-(18,21)
(18,23)-(18,24)
(18,30)-(18,34)
(18,30)-(18,43)
(18,30)-(18,43)
(18,36)-(18,37)
(18,36)-(18,43)
(18,39)-(18,40)
(18,42)-(18,43)
(19,12)-(19,16)
(19,12)-(19,25)
(19,12)-(19,25)
(19,18)-(19,19)
(19,18)-(19,25)
(19,21)-(19,22)
(19,24)-(19,25)
(20,12)-(20,16)
(20,12)-(20,25)
(20,12)-(20,25)
(20,18)-(20,19)
(20,18)-(20,25)
(20,21)-(20,22)
(20,24)-(20,25)
(22,9)-(22,13)
(22,9)-(22,22)
(22,9)-(22,22)
(22,9)-(22,42)
(22,9)-(22,42)
(22,9)-(23,73)
(22,15)-(22,16)
(22,15)-(22,22)
(22,18)-(22,19)
(22,21)-(22,22)
(22,29)-(22,33)
(22,29)-(22,42)
(22,29)-(22,42)
(22,35)-(22,36)
(22,35)-(22,42)
(22,38)-(22,39)
(22,41)-(22,42)
(23,10)-(23,19)
(23,10)-(23,73)
(23,22)-(23,26)
(23,22)-(23,35)
(23,22)-(23,35)
(23,22)-(23,55)
(23,28)-(23,29)
(23,28)-(23,35)
(23,31)-(23,32)
(23,34)-(23,35)
(23,42)-(23,46)
(23,42)-(23,55)
(23,42)-(23,55)
(23,48)-(23,49)
(23,48)-(23,55)
(23,51)-(23,52)
(23,54)-(23,55)
(23,60)-(23,64)
(23,60)-(23,73)
(23,60)-(23,73)
(23,66)-(23,67)
(23,66)-(23,73)
(23,69)-(23,70)
(23,72)-(23,73)
(24,21)-(24,25)
(24,21)-(24,34)
(24,21)-(24,34)
(24,21)-(24,54)
(24,27)-(24,28)
(24,27)-(24,34)
(24,30)-(24,31)
(24,33)-(24,34)
(24,41)-(24,45)
(24,41)-(24,54)
(24,41)-(24,54)
(24,47)-(24,48)
(24,47)-(24,54)
(24,50)-(24,51)
(24,53)-(24,54)
(25,24)-(25,28)
(25,24)-(25,37)
(25,24)-(25,37)
(25,24)-(25,57)
(25,24)-(25,67)
(25,30)-(25,31)
(25,30)-(25,37)
(25,33)-(25,34)
(25,36)-(25,37)
(25,44)-(25,48)
(25,44)-(25,57)
(25,44)-(25,57)
(25,50)-(25,51)
(25,50)-(25,57)
(25,53)-(25,54)
(25,56)-(25,57)
(25,64)-(25,67)
(26,17)-(26,20)
(26,17)-(26,42)
(26,22)-(26,24)
(26,22)-(26,42)
(26,29)-(26,33)
(26,29)-(26,42)
(26,29)-(26,42)
(26,35)-(26,36)
(26,35)-(26,42)
(26,38)-(26,39)
(26,41)-(26,42)
(27,15)-(27,18)
(27,15)-(27,40)
(27,20)-(27,22)
(27,20)-(27,40)
(27,27)-(27,31)
(27,27)-(27,40)
(27,27)-(27,40)
(27,33)-(27,34)
(27,33)-(27,40)
(27,36)-(27,37)
(27,39)-(27,40)
(28,14)-(28,23)
(28,14)-(28,56)
(28,14)-(28,56)
(28,25)-(28,28)
(28,25)-(28,50)
(28,30)-(28,32)
(28,30)-(28,50)
(28,37)-(28,41)
(28,37)-(28,50)
(28,37)-(28,50)
(28,43)-(28,44)
(28,43)-(28,50)
(28,46)-(28,47)
(28,49)-(28,50)
(28,55)-(28,56)
(29,14)-(29,15)
(30,14)-(30,15)
*)

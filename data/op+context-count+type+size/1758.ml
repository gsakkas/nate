
type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | Half of expr
  | ThreeAve of expr* expr* expr;;

let buildX () = VarX;;

let buildY () = VarY;;

let rec build (rand,depth) =
  match rand with
  | 0 ->
      let halff = rand (0, 2) in if halff = 0 then buildY () else buildX ()
  | 1 ->
      let halff = rand (0, 2) in
      if halff = 0
      then Cosine (build (rand, (depth - 1)))
      else Sine (build (rand, (depth - 1)))
  | 2 -> Average ((build (rand, (depth - 1))), (build (rand, (depth - 1))))
  | 3 -> Times ((build (rand, (depth - 1))), (build (rand, (depth - 1))));;


(* fix

type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | Half of expr
  | ThreeAve of expr* expr* expr;;

let buildX () = VarX;;

let buildY () = VarY;;

let rec build (rand,depth) =
  match depth with
  | 0 ->
      let halff = rand (0, 2) in if halff = 0 then buildY () else buildX ()
  | 1 ->
      let halff = rand (0, 2) in
      if halff = 0
      then Cosine (build (rand, (depth - 1)))
      else Sine (build (rand, (depth - 1)))
  | 2 -> Average ((build (rand, (depth - 1))), (build (rand, (depth - 1))))
  | 3 -> Times ((build (rand, (depth - 1))), (build (rand, (depth - 1))));;

*)

(* changed spans
(18,9)-(18,13)
(26,20)-(26,43)
(26,49)-(26,72)
(27,18)-(27,41)
(27,47)-(27,70)
*)

(* type error slice
(13,4)-(13,23)
(13,12)-(13,21)
(13,12)-(13,21)
(13,17)-(13,21)
(15,4)-(15,23)
(15,12)-(15,21)
(15,12)-(15,21)
(15,17)-(15,21)
(17,16)-(27,70)
(18,3)-(27,70)
(18,3)-(27,70)
(18,3)-(27,70)
(18,3)-(27,70)
(18,3)-(27,70)
(18,3)-(27,70)
(18,3)-(27,70)
(18,3)-(27,70)
(18,3)-(27,70)
(18,3)-(27,70)
(18,9)-(18,13)
(20,7)-(20,76)
(20,7)-(20,76)
(20,19)-(20,23)
(20,19)-(20,29)
(20,19)-(20,29)
(20,25)-(20,26)
(20,25)-(20,29)
(20,28)-(20,29)
(20,34)-(20,76)
(20,34)-(20,76)
(20,37)-(20,42)
(20,37)-(20,46)
(20,37)-(20,46)
(20,37)-(20,46)
(20,45)-(20,46)
(20,52)-(20,58)
(20,52)-(20,61)
(20,59)-(20,61)
(20,67)-(20,73)
(20,67)-(20,76)
(20,74)-(20,76)
(22,7)-(25,41)
(22,7)-(25,41)
(22,19)-(22,23)
(22,19)-(22,29)
(22,25)-(22,26)
(22,25)-(22,29)
(22,28)-(22,29)
(23,7)-(25,41)
(23,10)-(23,15)
(23,10)-(23,19)
(23,10)-(23,19)
(23,18)-(23,19)
(24,12)-(24,43)
(24,20)-(24,25)
(24,20)-(24,43)
(24,20)-(24,43)
(24,27)-(24,31)
(24,27)-(24,43)
(24,34)-(24,39)
(24,34)-(24,43)
(24,34)-(24,43)
(24,42)-(24,43)
(25,12)-(25,41)
(25,18)-(25,23)
(25,18)-(25,41)
(25,25)-(25,29)
(25,25)-(25,41)
(25,32)-(25,37)
(25,32)-(25,41)
(25,40)-(25,41)
(26,10)-(26,72)
(26,20)-(26,25)
(26,20)-(26,43)
(26,27)-(26,31)
(26,27)-(26,43)
(26,34)-(26,39)
(26,34)-(26,43)
(26,42)-(26,43)
(26,49)-(26,54)
(26,49)-(26,72)
(26,56)-(26,60)
(26,56)-(26,72)
(26,63)-(26,68)
(26,63)-(26,72)
(26,71)-(26,72)
(27,10)-(27,70)
(27,18)-(27,23)
(27,18)-(27,41)
(27,25)-(27,29)
(27,25)-(27,41)
(27,32)-(27,37)
(27,32)-(27,41)
(27,40)-(27,41)
(27,47)-(27,52)
(27,47)-(27,70)
(27,54)-(27,58)
(27,54)-(27,70)
(27,61)-(27,66)
(27,61)-(27,70)
(27,69)-(27,70)
*)

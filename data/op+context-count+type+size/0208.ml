
let rec padZero l1 l2 =
  let length1 = List.length l1 in
  let length2 = List.length l2 in
  if length1 = length2
  then (l1, l2)
  else
    if length1 < length2 then padZero (0 :: l1) l2 else padZero l1 (0 :: l2);;

let rec removeZero l =
  match l with | [] -> [] | h::t -> if h = 0 then removeZero t else l;;

let bigAdd l1 l2 =
  let add (l1,l2) =
    let f a x =
      let (eFromList1,eFromList2) = x in
      let (cin,result) = a in
      let sum = (eFromList1 + eFromList2) + cin in
      let tens = sum / 10 in
      let ones = sum mod 10 in (tens, (ones :: result)) in
    let base = (0, []) in
    let args = List.combine (List.rev (0 :: l1)) (List.rev (0 :: l2)) in
    let (_,res) = List.fold_left f base args in res in
  removeZero (add (padZero l1 l2));;

let rec mulByDigit i l =
  match i with
  | 0 -> []
  | 1 -> l
  | _ -> bigAdd ((bigAdd 1 1) (mulByDigit (i - 2) l));;


(* fix

let rec padZero l1 l2 =
  let length1 = List.length l1 in
  let length2 = List.length l2 in
  if length1 = length2
  then (l1, l2)
  else
    if length1 < length2 then padZero (0 :: l1) l2 else padZero l1 (0 :: l2);;

let rec removeZero l =
  match l with | [] -> [] | h::t -> if h = 0 then removeZero t else l;;

let bigAdd l1 l2 =
  let add (l1,l2) =
    let f a x =
      let (eFromList1,eFromList2) = x in
      let (cin,result) = a in
      let sum = (eFromList1 + eFromList2) + cin in
      let tens = sum / 10 in
      let ones = sum mod 10 in (tens, (ones :: result)) in
    let base = (0, []) in
    let args = List.combine (List.rev (0 :: l1)) (List.rev (0 :: l2)) in
    let (_,res) = List.fold_left f base args in res in
  removeZero (add (padZero l1 l2));;

let rec mulByDigit i l =
  if i = 0
  then []
  else if i = 1 then l else bigAdd (bigAdd l l) (mulByDigit (i - 2) l);;

*)

(* changed spans
(27,3)-(30,52)
(27,9)-(27,10)
(28,10)-(28,12)
(29,10)-(29,11)
(30,10)-(30,52)
(30,19)-(30,52)
(30,26)-(30,27)
(30,28)-(30,29)
(30,32)-(30,52)
(30,44)-(30,45)
(30,48)-(30,49)
*)

(* type error slice
(2,4)-(8,79)
(2,17)-(8,76)
(2,20)-(8,76)
(3,3)-(8,76)
(3,3)-(8,76)
(3,17)-(3,28)
(3,17)-(3,31)
(3,17)-(3,31)
(3,29)-(3,31)
(4,3)-(8,76)
(4,3)-(8,76)
(4,17)-(4,28)
(4,17)-(4,31)
(4,17)-(4,31)
(4,29)-(4,31)
(5,3)-(8,76)
(5,3)-(8,76)
(5,6)-(5,13)
(5,6)-(5,23)
(5,6)-(5,23)
(5,16)-(5,23)
(6,9)-(6,11)
(6,9)-(6,15)
(6,13)-(6,15)
(8,5)-(8,76)
(8,5)-(8,76)
(8,8)-(8,15)
(8,8)-(8,25)
(8,8)-(8,25)
(8,18)-(8,25)
(8,31)-(8,38)
(8,31)-(8,51)
(8,31)-(8,51)
(8,31)-(8,51)
(8,40)-(8,41)
(8,40)-(8,47)
(8,45)-(8,47)
(8,49)-(8,51)
(8,57)-(8,64)
(8,57)-(8,76)
(8,65)-(8,67)
(8,69)-(8,70)
(8,69)-(8,76)
(8,74)-(8,76)
(10,4)-(11,72)
(10,20)-(11,70)
(11,3)-(11,70)
(11,3)-(11,70)
(11,3)-(11,70)
(11,3)-(11,70)
(11,3)-(11,70)
(11,3)-(11,70)
(11,3)-(11,70)
(11,9)-(11,10)
(11,24)-(11,26)
(11,37)-(11,70)
(11,37)-(11,70)
(11,40)-(11,41)
(11,40)-(11,45)
(11,40)-(11,45)
(11,40)-(11,45)
(11,44)-(11,45)
(11,51)-(11,61)
(11,51)-(11,63)
(11,51)-(11,63)
(11,62)-(11,63)
(11,69)-(11,70)
(13,4)-(24,37)
(13,12)-(24,33)
(13,15)-(24,33)
(14,3)-(24,33)
(14,3)-(24,33)
(14,12)-(23,52)
(15,5)-(23,52)
(15,5)-(23,52)
(15,11)-(20,54)
(15,13)-(20,54)
(16,7)-(20,54)
(16,7)-(20,54)
(16,37)-(16,38)
(17,7)-(20,54)
(17,7)-(20,54)
(17,26)-(17,27)
(18,7)-(20,54)
(18,7)-(20,54)
(18,18)-(18,28)
(18,18)-(18,41)
(18,18)-(18,41)
(18,18)-(18,41)
(18,18)-(18,48)
(18,18)-(18,48)
(18,31)-(18,41)
(18,45)-(18,48)
(19,7)-(20,54)
(19,7)-(20,54)
(19,18)-(19,21)
(19,18)-(19,26)
(19,24)-(19,26)
(20,7)-(20,54)
(20,7)-(20,54)
(20,18)-(20,21)
(20,18)-(20,28)
(20,26)-(20,28)
(20,33)-(20,37)
(20,33)-(20,54)
(20,40)-(20,44)
(20,40)-(20,54)
(20,48)-(20,54)
(21,5)-(23,52)
(21,5)-(23,52)
(21,17)-(21,18)
(21,17)-(21,22)
(21,20)-(21,22)
(22,5)-(23,52)
(22,5)-(23,52)
(22,16)-(22,28)
(22,16)-(22,68)
(22,16)-(22,68)
(22,16)-(22,68)
(22,30)-(22,38)
(22,30)-(22,47)
(22,30)-(22,47)
(22,40)-(22,41)
(22,40)-(22,47)
(22,45)-(22,47)
(22,51)-(22,59)
(22,51)-(22,68)
(22,51)-(22,68)
(22,61)-(22,62)
(22,61)-(22,68)
(22,66)-(22,68)
(23,5)-(23,52)
(23,5)-(23,52)
(23,19)-(23,33)
(23,19)-(23,45)
(23,19)-(23,45)
(23,19)-(23,45)
(23,19)-(23,45)
(23,34)-(23,35)
(23,36)-(23,40)
(23,41)-(23,45)
(23,49)-(23,52)
(24,3)-(24,13)
(24,3)-(24,33)
(24,3)-(24,33)
(24,15)-(24,18)
(24,15)-(24,33)
(24,20)-(24,27)
(24,20)-(24,33)
(24,20)-(24,33)
(24,20)-(24,33)
(24,28)-(24,30)
(24,31)-(24,33)
(26,4)-(30,56)
(26,20)-(30,52)
(26,22)-(30,52)
(27,3)-(30,52)
(27,3)-(30,52)
(27,3)-(30,52)
(27,3)-(30,52)
(27,3)-(30,52)
(27,3)-(30,52)
(27,9)-(27,10)
(28,10)-(28,12)
(29,10)-(29,11)
(30,10)-(30,16)
(30,10)-(30,52)
(30,10)-(30,52)
(30,19)-(30,25)
(30,19)-(30,29)
(30,19)-(30,29)
(30,19)-(30,29)
(30,19)-(30,52)
(30,19)-(30,52)
(30,26)-(30,27)
(30,28)-(30,29)
(30,32)-(30,42)
(30,32)-(30,52)
(30,32)-(30,52)
(30,32)-(30,52)
(30,44)-(30,45)
(30,44)-(30,49)
(30,44)-(30,49)
(30,48)-(30,49)
(30,51)-(30,52)
*)


type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | Half of expr
  | ThreeAve of expr* expr* expr;;

let buildX () = VarX;;

let buildY () = VarY;;

let rec build (rand,depth) =
  let rdm = rand in
  match rdm with
  | 0 ->
      let halff = rand (0, 2) in if halff = 0 then buildY () else buildX ()
  | 1 ->
      let halff = rand (0, 2) in
      if halff = 0
      then Cosine (build (rand, (depth - 1)))
      else Sine (build (rand, (depth - 1)))
  | 2 -> Average ((build (rand, (depth - 1))), (build (rand, (depth - 1))))
  | 3 -> Times ((build (rand, (depth - 1))), (build (rand, (depth - 1))))
  | 4 ->
      Thresh
        ((build (rand, (depth - 1))), (build (rand, (depth - 1))),
          (build (rand, (depth - 1))), (build (rand, (depth - 1))));;


(* fix

type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | Half of expr
  | ThreeAve of expr* expr* expr;;

let buildX () = VarX;;

let buildY () = VarY;;

let rec build (rand,depth) =
  let rdm = rand (0, 7) in
  match rdm with
  | 0 -> buildY ()
  | 1 -> buildX ()
  | 2 -> Cosine (build (rand, (depth - 1)))
  | 3 -> Sine (build (rand, (depth - 1)))
  | 4 -> Average ((build (rand, (depth - 1))), (build (rand, (depth - 1))))
  | 5 -> Times ((build (rand, (depth - 1))), (build (rand, (depth - 1))))
  | 6 ->
      Thresh
        ((build (rand, (depth - 1))), (build (rand, (depth - 1))),
          (build (rand, (depth - 1))), (build (rand, (depth - 1))));;

*)

(* changed spans
(18,13)-(18,17)
(19,3)-(32,64)
(19,9)-(19,12)
(21,7)-(21,76)
(21,28)-(21,29)
(21,34)-(21,76)
(21,37)-(21,42)
(21,37)-(21,46)
(21,45)-(21,46)
(21,52)-(21,61)
(23,7)-(26,41)
(23,19)-(23,23)
(23,19)-(23,29)
(23,25)-(23,26)
(23,25)-(23,29)
(23,28)-(23,29)
(24,7)-(26,41)
(24,10)-(24,15)
(24,10)-(24,19)
(24,18)-(24,19)
(27,20)-(27,43)
(27,49)-(27,72)
(28,18)-(28,41)
(28,47)-(28,70)
(32,41)-(32,64)
*)

(* type error slice
(13,4)-(13,23)
(13,12)-(13,21)
(13,12)-(13,21)
(13,17)-(13,21)
(15,4)-(15,23)
(15,12)-(15,21)
(15,12)-(15,21)
(15,17)-(15,21)
(17,16)-(32,64)
(18,3)-(32,64)
(18,13)-(18,17)
(19,3)-(32,64)
(19,3)-(32,64)
(19,3)-(32,64)
(19,3)-(32,64)
(19,3)-(32,64)
(19,3)-(32,64)
(19,3)-(32,64)
(19,3)-(32,64)
(19,3)-(32,64)
(19,3)-(32,64)
(19,3)-(32,64)
(19,3)-(32,64)
(19,9)-(19,12)
(21,7)-(21,76)
(21,7)-(21,76)
(21,19)-(21,23)
(21,19)-(21,29)
(21,19)-(21,29)
(21,25)-(21,26)
(21,25)-(21,29)
(21,28)-(21,29)
(21,34)-(21,76)
(21,34)-(21,76)
(21,37)-(21,42)
(21,37)-(21,46)
(21,37)-(21,46)
(21,37)-(21,46)
(21,45)-(21,46)
(21,52)-(21,58)
(21,52)-(21,61)
(21,59)-(21,61)
(21,67)-(21,73)
(21,67)-(21,76)
(21,74)-(21,76)
(23,7)-(26,41)
(23,7)-(26,41)
(23,19)-(23,23)
(23,19)-(23,29)
(23,25)-(23,26)
(23,25)-(23,29)
(23,28)-(23,29)
(24,7)-(26,41)
(24,10)-(24,15)
(24,10)-(24,19)
(24,10)-(24,19)
(24,18)-(24,19)
(25,12)-(25,43)
(25,20)-(25,25)
(25,20)-(25,43)
(25,20)-(25,43)
(25,27)-(25,31)
(25,27)-(25,43)
(25,34)-(25,39)
(25,34)-(25,43)
(25,34)-(25,43)
(25,42)-(25,43)
(26,12)-(26,41)
(26,18)-(26,23)
(26,18)-(26,41)
(26,25)-(26,29)
(26,25)-(26,41)
(26,32)-(26,37)
(26,32)-(26,41)
(26,40)-(26,41)
(27,10)-(27,72)
(27,20)-(27,25)
(27,20)-(27,43)
(27,27)-(27,31)
(27,27)-(27,43)
(27,34)-(27,39)
(27,34)-(27,43)
(27,42)-(27,43)
(27,49)-(27,54)
(27,49)-(27,72)
(27,56)-(27,60)
(27,56)-(27,72)
(27,63)-(27,68)
(27,63)-(27,72)
(27,71)-(27,72)
(28,10)-(28,70)
(28,18)-(28,23)
(28,18)-(28,41)
(28,25)-(28,29)
(28,25)-(28,41)
(28,32)-(28,37)
(28,32)-(28,41)
(28,40)-(28,41)
(28,47)-(28,52)
(28,47)-(28,70)
(28,54)-(28,58)
(28,54)-(28,70)
(28,61)-(28,66)
(28,61)-(28,70)
(28,69)-(28,70)
(30,7)-(32,64)
(31,11)-(31,16)
(31,11)-(31,34)
(31,18)-(31,22)
(31,18)-(31,34)
(31,25)-(31,30)
(31,25)-(31,34)
(31,33)-(31,34)
(31,40)-(31,45)
(31,40)-(31,63)
(31,47)-(31,51)
(31,47)-(31,63)
(31,54)-(31,59)
(31,54)-(31,63)
(31,62)-(31,63)
(32,12)-(32,17)
(32,12)-(32,35)
(32,19)-(32,23)
(32,19)-(32,35)
(32,26)-(32,31)
(32,26)-(32,35)
(32,34)-(32,35)
(32,41)-(32,46)
(32,41)-(32,64)
(32,48)-(32,52)
(32,48)-(32,64)
(32,55)-(32,60)
(32,55)-(32,64)
(32,63)-(32,64)
*)

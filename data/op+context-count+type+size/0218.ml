
type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | NewA of expr* expr
  | NewB of expr* expr* expr;;

let rec exprToString e =
  let s = "" in
  match e with
  | VarX  -> s ^ "x"
  | VarY  -> s ^ "y"
  | Sine a -> s ^ ("sin(pi*" ^ ((exprToString a) ^ ")"))
  | Cosine a -> s ^ ("cos(pi*" ^ ((exprToString a) ^ ")"))
  | Average (a,b) ->
      s ^ ("((" ^ ((exprToString a) ^ ("+" ^ ((exprToString b) ^ "/2)"))))
  | Times (a,b) -> s ^ ((exprToString a) ^ ("*" ^ (exprToString b)))
  | Thresh (a,b,c,d) ->
      s ^
        ("(" ^
           ((exprToString a) ^
              ("<" ^
                 ((exprToString b) ^
                    ("?" ^
                       ((exprToString c) ^ (":" ^ ((exprToString d) ^ ")"))))))))
  | NewA (a,b) ->
      s ^
        ("sin(pi*" ^
           ((exprToString a) ^ (")*cos(pi*" ^ ((exprToString b) ^ ")"))))
  | NewB (a,b,c) ->
      s ^
        ("(" ^
           ((exprToString a) ^
              ("+" ^ ((exprToString b) ^ (("+" + (exprToString c)) ^ ")^0")))));;


(* fix

type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | NewA of expr* expr
  | NewB of expr* expr* expr;;

let rec exprToString e =
  let s = "" in
  match e with
  | VarX  -> s ^ "x"
  | VarY  -> s ^ "y"
  | Sine a -> s ^ ("sin(pi*" ^ ((exprToString a) ^ ")"))
  | Cosine a -> s ^ ("cos(pi*" ^ ((exprToString a) ^ ")"))
  | Average (a,b) ->
      s ^ ("((" ^ ((exprToString a) ^ ("+" ^ ((exprToString b) ^ "/2)"))))
  | Times (a,b) -> s ^ ((exprToString a) ^ ("*" ^ (exprToString b)))
  | Thresh (a,b,c,d) ->
      s ^
        ("(" ^
           ((exprToString a) ^
              ("<" ^
                 ((exprToString b) ^
                    ("?" ^
                       ((exprToString c) ^ (":" ^ ((exprToString d) ^ ")"))))))))
  | NewA (a,b) ->
      s ^
        ("sin(pi*" ^
           ((exprToString a) ^ (")*cos(pi*" ^ ((exprToString b) ^ ")"))))
  | NewB (a,b,c) ->
      s ^
        ("(" ^
           ((exprToString a) ^
              ("+" ^ ((exprToString b) ^ ("+" ^ ((exprToString c) ^ ")^0"))))));;

*)

(* changed spans
(39,44)-(39,65)
(39,51)-(39,65)
*)

(* type error slice
(13,22)-(39,75)
(14,3)-(39,75)
(14,11)-(14,13)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,3)-(39,75)
(15,9)-(15,10)
(16,14)-(16,15)
(16,14)-(16,21)
(16,16)-(16,17)
(16,18)-(16,21)
(17,14)-(17,15)
(17,14)-(17,21)
(17,16)-(17,17)
(17,18)-(17,21)
(18,15)-(18,16)
(18,15)-(18,55)
(18,17)-(18,18)
(18,20)-(18,29)
(18,20)-(18,55)
(18,30)-(18,31)
(18,34)-(18,46)
(18,34)-(18,48)
(18,34)-(18,48)
(18,34)-(18,55)
(18,34)-(18,55)
(18,47)-(18,48)
(18,50)-(18,51)
(18,52)-(18,55)
(19,17)-(19,18)
(19,17)-(19,57)
(19,19)-(19,20)
(19,22)-(19,31)
(19,22)-(19,57)
(19,32)-(19,33)
(19,36)-(19,48)
(19,36)-(19,50)
(19,36)-(19,57)
(19,49)-(19,50)
(19,52)-(19,53)
(19,54)-(19,57)
(21,7)-(21,8)
(21,7)-(21,71)
(21,9)-(21,10)
(21,12)-(21,16)
(21,12)-(21,71)
(21,17)-(21,18)
(21,21)-(21,33)
(21,21)-(21,35)
(21,21)-(21,71)
(21,34)-(21,35)
(21,37)-(21,38)
(21,40)-(21,43)
(21,40)-(21,71)
(21,44)-(21,45)
(21,48)-(21,60)
(21,48)-(21,62)
(21,48)-(21,71)
(21,61)-(21,62)
(21,64)-(21,65)
(21,66)-(21,71)
(22,20)-(22,21)
(22,20)-(22,66)
(22,22)-(22,23)
(22,26)-(22,38)
(22,26)-(22,40)
(22,26)-(22,66)
(22,39)-(22,40)
(22,42)-(22,43)
(22,45)-(22,48)
(22,45)-(22,66)
(22,49)-(22,50)
(22,52)-(22,64)
(22,52)-(22,66)
(22,65)-(22,66)
(24,7)-(24,8)
(24,7)-(30,74)
(24,9)-(24,10)
(25,10)-(25,13)
(25,10)-(30,74)
(25,14)-(25,15)
(26,14)-(26,26)
(26,14)-(26,28)
(26,14)-(30,74)
(26,27)-(26,28)
(26,30)-(26,31)
(27,16)-(27,19)
(27,16)-(30,74)
(27,20)-(27,21)
(28,20)-(28,32)
(28,20)-(28,34)
(28,20)-(30,74)
(28,33)-(28,34)
(28,36)-(28,37)
(29,22)-(29,25)
(29,22)-(30,74)
(29,26)-(29,27)
(30,26)-(30,38)
(30,26)-(30,40)
(30,26)-(30,74)
(30,39)-(30,40)
(30,42)-(30,43)
(30,45)-(30,48)
(30,45)-(30,74)
(30,49)-(30,50)
(30,53)-(30,65)
(30,53)-(30,67)
(30,53)-(30,74)
(30,66)-(30,67)
(30,69)-(30,70)
(30,71)-(30,74)
(32,7)-(32,8)
(32,7)-(34,70)
(32,9)-(32,10)
(33,10)-(33,19)
(33,10)-(34,70)
(33,20)-(33,21)
(34,14)-(34,26)
(34,14)-(34,28)
(34,14)-(34,70)
(34,27)-(34,28)
(34,30)-(34,31)
(34,33)-(34,44)
(34,33)-(34,70)
(34,45)-(34,46)
(34,49)-(34,61)
(34,49)-(34,63)
(34,49)-(34,70)
(34,62)-(34,63)
(34,65)-(34,66)
(34,67)-(34,70)
(36,7)-(36,8)
(36,9)-(36,10)
(37,10)-(37,13)
(37,14)-(37,15)
(38,14)-(38,26)
(38,14)-(38,28)
(38,27)-(38,28)
(38,30)-(38,31)
(39,16)-(39,19)
(39,20)-(39,21)
(39,24)-(39,36)
(39,24)-(39,38)
(39,37)-(39,38)
(39,40)-(39,41)
(39,44)-(39,47)
(39,44)-(39,65)
(39,44)-(39,65)
(39,44)-(39,65)
(39,44)-(39,75)
(39,44)-(39,75)
(39,51)-(39,63)
(39,51)-(39,65)
(39,64)-(39,65)
(39,68)-(39,69)
(39,70)-(39,75)
*)

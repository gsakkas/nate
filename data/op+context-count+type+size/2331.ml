
let rec digitsOfInt n =
  if n <= 0
  then []
  else
    (let rec loop n a = if n = 0 then a else loop (n / 10) ((n mod 10) :: a) in
     match n with | 0 -> [0] | _ -> loop n []);;

let rec sumList xs = match xs with | [] -> 0 | x::xs' -> x + (sumList xs');;

let rec additivePersistence n =
  if n < 10 then n else n = (sumList (digitsOfInt n));;


(* fix

let a = int_of_char '3';;

let rec digitsOfInt n =
  if n <= 0
  then []
  else
    (let rec loop n a = if n = 0 then a else loop (n / 10) ((n mod 10) :: a) in
     match n with | 0 -> [0] | _ -> loop n []);;

let rec sumList xs = match xs with | [] -> 0 | x::xs' -> x + (sumList xs');;

let rec additivePersistence n =
  if n < 10 then a else additivePersistence (sumList (digitsOfInt n));;

*)

(* changed spans
(2,21)-(7,46)
(12,18)-(12,19)
(12,25)-(12,26)
(12,25)-(12,52)
(12,30)-(12,37)
(12,39)-(12,50)
(12,51)-(12,52)
*)

(* type error slice
(2,4)-(7,49)
(2,21)-(7,46)
(3,3)-(7,46)
(3,3)-(7,46)
(3,6)-(3,7)
(3,6)-(3,12)
(3,6)-(3,12)
(3,6)-(3,12)
(3,11)-(3,12)
(4,8)-(4,10)
(6,6)-(7,46)
(6,6)-(7,46)
(6,19)-(6,76)
(6,21)-(6,76)
(6,25)-(6,76)
(6,25)-(6,76)
(6,28)-(6,29)
(6,28)-(6,33)
(6,28)-(6,33)
(6,28)-(6,33)
(6,32)-(6,33)
(6,39)-(6,40)
(6,46)-(6,50)
(6,46)-(6,76)
(6,46)-(6,76)
(6,46)-(6,76)
(6,52)-(6,53)
(6,52)-(6,58)
(6,56)-(6,58)
(6,62)-(6,63)
(6,62)-(6,70)
(6,62)-(6,76)
(6,68)-(6,70)
(6,75)-(6,76)
(7,6)-(7,46)
(7,6)-(7,46)
(7,6)-(7,46)
(7,12)-(7,13)
(7,26)-(7,29)
(7,26)-(7,29)
(7,27)-(7,28)
(7,37)-(7,41)
(7,37)-(7,46)
(7,37)-(7,46)
(7,42)-(7,43)
(7,44)-(7,46)
(9,4)-(9,77)
(9,17)-(9,74)
(9,22)-(9,74)
(9,22)-(9,74)
(9,22)-(9,74)
(9,22)-(9,74)
(9,22)-(9,74)
(9,22)-(9,74)
(9,28)-(9,30)
(9,44)-(9,45)
(9,58)-(9,59)
(9,58)-(9,74)
(9,58)-(9,74)
(9,58)-(9,74)
(9,63)-(9,70)
(9,63)-(9,74)
(9,63)-(9,74)
(9,71)-(9,74)
(11,4)-(12,56)
(11,29)-(12,52)
(12,3)-(12,52)
(12,3)-(12,52)
(12,6)-(12,7)
(12,6)-(12,12)
(12,6)-(12,12)
(12,6)-(12,12)
(12,10)-(12,12)
(12,18)-(12,19)
(12,25)-(12,26)
(12,25)-(12,52)
(12,25)-(12,52)
(12,30)-(12,37)
(12,30)-(12,52)
(12,30)-(12,52)
(12,39)-(12,50)
(12,39)-(12,52)
(12,51)-(12,52)
*)

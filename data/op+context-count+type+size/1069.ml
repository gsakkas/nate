
type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | FiboPlus of expr* expr* expr* expr* expr
  | TheThing of expr* expr* expr;;

let rec exprToString e =
  match e with
  | VarX  -> "x"
  | VarY  -> "y"
  | Sine ex -> "sin(pi*" ^ ((exprToString ex) ^ ")")
  | Cosine ex -> "cos(pi*" ^ ((exprToString ex) ^ ")")
  | Average (ex1,ex2) ->
      "((" ^ ((exprToString ex1) ^ ("+" ^ ((exprToString ex2) ^ ")/2)")))
  | Times (ex1,ex2) -> (exprToString ex1) ^ ("*" ^ (exprToString ex2))
  | Thresh (ex1,ex2,ex3,ex4) ->
      "(" ^
        ((exprToString ex1) ^
           ("<" ^
              ((exprToString ex2) ^
                 ("?" ^
                    ((exprToString ex3) ^ (":" ^ ((exprToString ex4) ^ ")")))))))
  | FiboPlus (ex1,ex2,ex3,ex4,ex5) ->
      "((" ^
        ((exprToString ex1) ^
           (")*(" ^
              ((exprToString ex1) ^
                 ("+" ^
                    ((exprToString ex2) ^
                       (")*(" ^
                          ((exprToString ex1) ^
                             ("+" ^
                                ((exprToString ex2) ^
                                   ("+" ^
                                      ((exprToString ex3) ^
                                         (")*(" ^
                                            ((exprToString ex1) ^
                                               ("+" ^
                                                  ((exprToString ex2) ^
                                                     ("+" ^
                                                        ((exprToString ex3) ^
                                                           ("+" ^
                                                              ((exprToString
                                                                  ex4)
                                                                 ^
                                                                 (")*(" ^
                                                                    (
                                                                    (exprToString
                                                                    ex1) ^
                                                                    ("+" ^
                                                                    ((exprToString
                                                                    ex2) ^
                                                                    ("+" ^
                                                                    ((exprToString
                                                                    ex3) ^
                                                                    ("+" ^
                                                                    ((exprToString
                                                                    ex4) ^
                                                                    ("+" ^
                                                                    ((exprToString
                                                                    ex5) ^
                                                                    "))")))))))))))))))))))))))))))))
  | TheThing (ex1,ex2,ex3) ->
      "(" ^
        ((exprToString ex1) ^
           ("*sin(" ^
              ((exprToString ex2) ^ ((")*cos(" exprToString ex3) ^ (")" ")")))));;


(* fix

type expr =
  | VarX
  | VarY
  | Sine of expr
  | Cosine of expr
  | Average of expr* expr
  | Times of expr* expr
  | Thresh of expr* expr* expr* expr
  | FiboPlus of expr* expr* expr* expr* expr
  | TheThing of expr* expr* expr;;

let rec exprToString e =
  match e with
  | VarX  -> "x"
  | VarY  -> "y"
  | Sine ex -> "sin(pi*" ^ ((exprToString ex) ^ ")")
  | Cosine ex -> "cos(pi*" ^ ((exprToString ex) ^ ")")
  | Average (ex1,ex2) ->
      "((" ^ ((exprToString ex1) ^ ("+" ^ ((exprToString ex2) ^ ")/2)")))
  | Times (ex1,ex2) -> (exprToString ex1) ^ ("*" ^ (exprToString ex2))
  | Thresh (ex1,ex2,ex3,ex4) ->
      "(" ^
        ((exprToString ex1) ^
           ("<" ^
              ((exprToString ex2) ^
                 ("?" ^
                    ((exprToString ex3) ^ (":" ^ ((exprToString ex4) ^ ")")))))))
  | FiboPlus (ex1,ex2,ex3,ex4,ex5) ->
      "((" ^
        ((exprToString ex1) ^
           (")*(" ^
              ((exprToString ex1) ^
                 ("+" ^
                    ((exprToString ex2) ^
                       (")*(" ^
                          ((exprToString ex1) ^
                             ("+" ^
                                ((exprToString ex2) ^
                                   ("+" ^
                                      ((exprToString ex3) ^
                                         (")*(" ^
                                            ((exprToString ex1) ^
                                               ("+" ^
                                                  ((exprToString ex2) ^
                                                     ("+" ^
                                                        ((exprToString ex3) ^
                                                           ("+" ^
                                                              ((exprToString
                                                                  ex4)
                                                                 ^
                                                                 (")*(" ^
                                                                    (
                                                                    (exprToString
                                                                    ex1) ^
                                                                    ("+" ^
                                                                    ((exprToString
                                                                    ex2) ^
                                                                    ("+" ^
                                                                    ((exprToString
                                                                    ex3) ^
                                                                    ("+" ^
                                                                    ((exprToString
                                                                    ex4) ^
                                                                    ("+" ^
                                                                    ((exprToString
                                                                    ex5) ^
                                                                    "))")))))))))))))))))))))))))))))
  | TheThing (ex1,ex2,ex3) ->
      "(" ^
        ((exprToString ex1) ^
           ("*sin(" ^
              ((exprToString ex2) ^ (")*cos(" ^ ((exprToString ex3) ^ "))")))));;

*)

(* changed spans
(73,39)-(73,64)
(73,48)-(73,60)
(73,69)-(73,72)
(73,69)-(73,76)
(73,73)-(73,76)
*)

(* type error slice
(13,22)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,3)-(73,76)
(14,9)-(14,10)
(17,16)-(17,25)
(17,16)-(17,52)
(17,26)-(17,27)
(17,30)-(17,42)
(17,30)-(17,45)
(17,30)-(17,45)
(17,30)-(17,52)
(17,30)-(17,52)
(17,43)-(17,45)
(17,47)-(17,48)
(17,49)-(17,52)
(18,18)-(18,27)
(18,18)-(18,54)
(18,28)-(18,29)
(18,32)-(18,44)
(18,32)-(18,47)
(18,32)-(18,54)
(18,45)-(18,47)
(18,49)-(18,50)
(18,51)-(18,54)
(20,7)-(20,11)
(20,7)-(20,71)
(20,12)-(20,13)
(20,16)-(20,28)
(20,16)-(20,32)
(20,16)-(20,71)
(20,29)-(20,32)
(20,34)-(20,35)
(20,37)-(20,40)
(20,37)-(20,71)
(20,41)-(20,42)
(20,45)-(20,57)
(20,45)-(20,61)
(20,45)-(20,71)
(20,58)-(20,61)
(20,63)-(20,64)
(20,65)-(20,71)
(21,25)-(21,37)
(21,25)-(21,41)
(21,25)-(21,69)
(21,38)-(21,41)
(21,43)-(21,44)
(21,46)-(21,49)
(21,46)-(21,69)
(21,50)-(21,51)
(21,53)-(21,65)
(21,53)-(21,69)
(21,66)-(21,69)
(23,7)-(23,10)
(23,7)-(28,75)
(23,11)-(23,12)
(24,11)-(24,23)
(24,11)-(24,27)
(24,11)-(28,75)
(24,24)-(24,27)
(24,29)-(24,30)
(25,13)-(25,16)
(25,13)-(28,75)
(25,17)-(25,18)
(26,17)-(26,29)
(26,17)-(26,33)
(26,17)-(28,75)
(26,30)-(26,33)
(26,35)-(26,36)
(27,19)-(27,22)
(27,19)-(28,75)
(27,23)-(27,24)
(28,23)-(28,35)
(28,23)-(28,39)
(28,23)-(28,75)
(28,36)-(28,39)
(28,41)-(28,42)
(28,44)-(28,47)
(28,44)-(28,75)
(28,48)-(28,49)
(28,52)-(28,64)
(28,52)-(28,68)
(28,52)-(28,75)
(28,65)-(28,68)
(28,70)-(28,71)
(28,72)-(28,75)
(30,7)-(30,11)
(30,7)-(68,73)
(30,12)-(30,13)
(31,11)-(31,23)
(31,11)-(31,27)
(31,11)-(68,73)
(31,24)-(31,27)
(31,29)-(31,30)
(32,13)-(32,18)
(32,13)-(68,73)
(32,19)-(32,20)
(33,17)-(33,29)
(33,17)-(33,33)
(33,17)-(68,73)
(33,30)-(33,33)
(33,35)-(33,36)
(34,19)-(34,22)
(34,19)-(68,73)
(34,23)-(34,24)
(35,23)-(35,35)
(35,23)-(35,39)
(35,23)-(68,73)
(35,36)-(35,39)
(35,41)-(35,42)
(36,25)-(36,30)
(36,25)-(68,73)
(36,31)-(36,32)
(37,29)-(37,41)
(37,29)-(37,45)
(37,29)-(68,73)
(37,42)-(37,45)
(37,47)-(37,48)
(38,31)-(38,34)
(38,31)-(68,73)
(38,35)-(38,36)
(39,35)-(39,47)
(39,35)-(39,51)
(39,35)-(68,73)
(39,48)-(39,51)
(39,53)-(39,54)
(40,37)-(40,40)
(40,37)-(68,73)
(40,41)-(40,42)
(41,41)-(41,53)
(41,41)-(41,57)
(41,41)-(68,73)
(41,54)-(41,57)
(41,59)-(41,60)
(42,43)-(42,48)
(42,43)-(68,73)
(42,49)-(42,50)
(43,47)-(43,59)
(43,47)-(43,63)
(43,47)-(68,73)
(43,60)-(43,63)
(43,65)-(43,66)
(44,49)-(44,52)
(44,49)-(68,73)
(44,53)-(44,54)
(45,53)-(45,65)
(45,53)-(45,69)
(45,53)-(68,73)
(45,66)-(45,69)
(45,71)-(45,72)
(46,55)-(46,58)
(46,55)-(68,73)
(46,59)-(46,60)
(47,59)-(47,71)
(47,59)-(47,75)
(47,59)-(68,73)
(47,72)-(47,75)
(47,77)-(47,78)
(48,61)-(48,64)
(48,61)-(68,73)
(48,65)-(48,66)
(49,65)-(49,77)
(49,65)-(50,70)
(49,65)-(68,73)
(50,67)-(50,70)
(51,66)-(51,67)
(52,67)-(52,72)
(52,67)-(68,73)
(52,73)-(52,74)
(54,70)-(54,82)
(54,70)-(55,72)
(54,70)-(68,73)
(55,69)-(55,72)
(55,74)-(55,75)
(56,70)-(56,73)
(56,70)-(68,73)
(56,74)-(56,75)
(57,71)-(57,83)
(57,71)-(58,72)
(57,71)-(68,73)
(58,69)-(58,72)
(58,74)-(58,75)
(59,70)-(59,73)
(59,70)-(68,73)
(59,74)-(59,75)
(60,71)-(60,83)
(60,71)-(61,72)
(60,71)-(68,73)
(61,69)-(61,72)
(61,74)-(61,75)
(62,70)-(62,73)
(62,70)-(68,73)
(62,74)-(62,75)
(63,71)-(63,83)
(63,71)-(64,72)
(63,71)-(68,73)
(64,69)-(64,72)
(64,74)-(64,75)
(65,70)-(65,73)
(65,70)-(68,73)
(65,74)-(65,75)
(66,71)-(66,83)
(66,71)-(67,72)
(66,71)-(68,73)
(67,69)-(67,72)
(67,74)-(67,75)
(68,69)-(68,73)
(70,7)-(70,10)
(70,11)-(70,12)
(71,11)-(71,23)
(71,11)-(71,27)
(71,24)-(71,27)
(71,29)-(71,30)
(72,13)-(72,20)
(72,21)-(72,22)
(73,17)-(73,29)
(73,17)-(73,33)
(73,30)-(73,33)
(73,35)-(73,36)
(73,39)-(73,47)
(73,39)-(73,64)
(73,48)-(73,60)
(73,61)-(73,64)
(73,66)-(73,67)
(73,69)-(73,72)
(73,69)-(73,76)
(73,73)-(73,76)
*)
